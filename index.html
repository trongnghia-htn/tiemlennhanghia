<!-- ver 1.0.2 -->

<!DOCTYPE html>
<html lang="vi">
<head>
    <link rel="stylesheet" href="style.css">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7LYGRT2QND"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-7LYGRT2QND');
    </script>
    <meta charset="UTF-8">
    <title>Ti·ªám Len Nh√† Nghƒ©a - Wool & Handmade</title>
    <meta name="description" content="Ti·ªám Len Nh√† Nghƒ©a chuy√™n ƒë·ªì len handmade, ph·ª• ki·ªán len, qu√† t·∫∑ng len d·ªÖ th∆∞∆°ng, nh·∫≠n l√†m theo y√™u c·∫ßu, gi√° c·∫£ h·ª£p l√Ω, ch·∫•t l∆∞·ª£ng uy t√≠n.">
    <meta name="keywords" content="ti·ªám len, len handmade, ph·ª• ki·ªán len, qu√† t·∫∑ng len, Ti·ªám Len Nh√† Nghƒ©a, ƒë·ªì len, handmade, m√≥c len, qu√† t·∫∑ng, Nghƒ©a b√°n len">
    <meta name="author" content="Ti·ªám Len Nh√† Nghƒ©a">
    <meta property="og:title" content="Ti·ªám Len Nh√† Nghƒ©a - Wool & Handmade">
    <meta property="og:description" content="Ti·ªám Len Nh√† Nghƒ©a chuy√™n ƒë·ªì len handmade, ph·ª• ki·ªán len, qu√† t·∫∑ng len d·ªÖ th∆∞∆°ng, nh·∫≠n l√†m theo y√™u c·∫ßu.">
    <meta property="og:image" content="https://trongnghia-htn.github.io/tiemlennhanghia/photos/thumnail.png">
    <meta property="og:url" content="https://trongnghia-htn.github.io/tiemlennhanghia/">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Ti·ªám Len Nh√† Nghƒ©a">
    <link rel="preload" as="image" href="photos/intro.png">
    <link rel="icon" type="image/webp" href="photos/logo.webp">
    <meta name="google-site-verification" content="WgGeR9djbx2N4OKYuFHXf3Wxcw9Tg5i7oXHJkxgwXKE" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Store",
      "name": "Ti·ªám Len Nh√† Nghƒ©a",
      "image": "https://trongnghia-htn.github.io/tiemlennhanghia/photos/logo.png",
      "url": "https://trongnghia-htn.github.io/tiemlennhanghia/",
      "description": "Ti·ªám Len Nh√† Nghƒ©a chuy√™n cung c·∫•p s·∫£n ph·∫©m, ph·ª• ki·ªán, m√≥c kh√≥a, ƒë·ªì trang tr√≠ b·∫±ng len s·ª£i ƒë∆∞·ª£c l√†m th·ªß c√¥ng an to√†n, ch·∫•t l∆∞·ª£ng cao, nh·∫≠n v·∫≠n chuy·ªÉn to√†n qu·ªëc."
    }
    </script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Ti·ªám Len Nh√† Nghƒ©a",
      "url": "https://trongnghia-htn.github.io/tiemlennhanghia/"
    }
    </script>
    <script src="searchUtils.js"></script>
    
</head>
<body class="hidden-body">
    <div id="intro-overlay">
        <div style="display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:380px;">
                <img src="photos/intro.png" alt="Ti·ªám Len Nh√† Nghƒ©a" style="width:440px;max-width:98vw;background:transparent;display:block;margin:auto;box-shadow:none;border-radius:0;">
        </div>
    </div>
    <div class="row">
        <div onclick="location.reload()" style="cursor:pointer;display:inline-block;">
            <img src="photos/logo.webp" alt="LOGO">
        </div>
        <div>
            <h1>Ti·ªám Len Nh√† Nghƒ©a</h1>
            <div>
              <p class="contact">Gi√° c·∫£ h·ª£p l√≠ üòò</p><br>
                <p class="contact">ƒêa d·∫°ng m·∫´u m√£ üåª</p><br>
                <p class="contact">C√≥ nh·∫≠n l√†m theo y√™u c·∫ßu üéá</p> <br>
            </div>
        </div>
    </div>
    <div class="marquee-wrap">
        <nav class="menu">
            <a href="#tiemkim" title="T√¨m ki·∫øm">
                <svg width="1.7em" height="1.7em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round" style="vertical-align:middle;">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                </svg>
            </a>
            <a href="#lienhe" title="Li√™n h·ªá">
                <svg width="1.7em" height="1.7em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round" style="vertical-align:middle;">
                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                </svg>
            </a>
        </nav>
        <div id="search-popup" class="dynamic-popup">
        <div class="dynamic-content" id="search-content">
            <input type="search" id="searchInput" placeholder="B·∫°n c·∫ßn g√¨ n√®..." inputmode="search" enterkeyhint="search" autocomplete="off">
            <div id="searchResult" style="font-size:0.95em;color:#333;text-align:left;"></div>
        </div>
    </div>
        <hr>
        <p class="hello">Th√≠ch l√† ch·ªët, mi·ªÖn sao m√¨nh vui l√† ƒë∆∞·ª£c!üòç</p>
    </div>
    <div id="zoom-view" style="display:none;">
        <img class="zoom-img" src="" alt="">
        <div class="zoom-info">
            <button class="zoom-close" title="ƒê√≥ng">&times;</button>
            <h2 class="zoom-title"></h2>
            <div class="zoom-price"></div>
            <div class="zoom-size-color"></div>
            <p class="zoom-intro"></p>
        </div>
    </div>
    
    <div class="gallery"></div>
    <!-- ƒê·∫∑t popup t√¨m ki·∫øm tr∆∞·ªõc gallery -->
    
    <div id="gallery-message" style="text-align:center;margin:16px 0 0 0;"></div>
            <!-- Modal th√¥ng b√°o h∆∞·ªõng d·∫´n -->
                    <div id="modal-huongdan" style="display:none;position:fixed;z-index:20000;left:0;top:0;width:100vw;height:100vh;background:rgba(0,0,0,0.45);justify-content:center;align-items:center;">
                        <div style="position:relative;display:inline-block;">
                            <img src="photos/huongdan.webp" alt="H∆∞·ªõng d·∫´n" style="max-width:90vw;max-height:85vh;border-radius:16px;box-shadow:0 4px 32px #000b;display:block;"/>
                            <button id="close-huongdan" style="position:absolute;top:8px;right:12px;font-size:2.2em;background:none;border:none;color:#a8520c;cursor:pointer;z-index:2;line-height:1;">&times;</button>
                        </div>
                    </div>
    <div id="dynamic-popup" class="dynamic-popup">
        <div class="dynamic-content" id="dynamic-content">
            <div style="text-align:center;">
                <strong>Li√™n H·ªá</strong>
            </div>
            <hr style="margin: 20px 10;">
            <div style="font-size:0.8em;opacity:0.8;">
                --Ti·ªám t·∫°m ƒë√≥ng c·ª≠a ü§ß--</a>
                <br>
                FACEBOOK: <a href="https://www.facebook.com/share/1F2p2B7MUk/" target="_blank">Ti·ªám Len Nh√† Nghƒ©a</a>
                <br>
                TIKTOK: <a href="https://www.tiktok.com/@tiemlennhanghia" target="_blank">@tiemlennhanghia</a>
                <br>
                INSTAGRAM: <a href="https://www.instagram.com/tiemlennhanghia/" target="_blank">@tiemlennhanghia</a>
            </div>
        </div>
    </div>
    <div id="product-popup" class="dynamic-popup" style="z-index:10000;">
        <div class="dynamic-content" id="product-content" style="position:relative;">
            <span id="close-product-popup" style="position:absolute;top:12px;right:18px;font-size:1.5em;cursor:pointer;color:#e53935;">&times;</span>
            <div id="product-info"></div>
        </div>
    </div>
    <div class="footer-end">
        
        Thi·∫øt k·∫ø v√† ph√°t tri·ªÉn b·ªüi Ch·ªß Ti·ªám!</a> <br>
    </div>
    <script src="products.js"></script>
    <script>
    
    function loadGalleryImages(callback) {
        const cacheKey = 'galleryImagesCache_v1';
        const cache = localStorage.getItem(cacheKey);
        if (cache) {
            try {
                window.galleryImages = JSON.parse(cache);
                callback();
                return;
            } catch (e) {
                localStorage.removeItem(cacheKey);
            }
        }
        
        const script = document.createElement('script');
        script.src = 'galleryImages.js';
        script.onload = function() {
            if (window.galleryImages) {
                try {
                    localStorage.setItem(cacheKey, JSON.stringify(window.galleryImages));
                } catch (e) {}
            }
            callback();
        };
        document.head.appendChild(script);
    }
    </script>
    <script>
        const gallery = document.querySelector('.gallery');
        const searchInput = document.getElementById('searchInput');
        const zoomView = document.getElementById('zoom-view');
        let PAGE_SIZE = window.innerWidth <= 600 ? 10 : 15;
        let currentPage = 1;
        let searchTimeout;
        let isSearching = false;
        let searchResults = [];
        let searchPage = 1;

        
        function renderGalleryPage(page) {
            gallery.classList.add('loading');
            gallery.style.display = 'none';
            requestAnimationFrame(() => {
                const start = (page - 1) * PAGE_SIZE;
                const end = Math.min(start + PAGE_SIZE, galleryImages.length);
                const items = end - start;
                
                const fragment = document.createDocumentFragment();
                for (let i = 0; i < items; i++) {
                    const imgData = galleryImages[start + i];
                    const figure = document.createElement('figure');
                    const img = document.createElement('img');
                    img.width = 200;
                    img.height = 200;
                    img.loading = "lazy";
                    img.style.display = "block";
                    img.src = imgData.src;
                    img.alt = imgData.code;
                    figure.appendChild(img);
                    const caption = document.createElement('figcaption');
                    caption.textContent = imgData.code;
                    figure.appendChild(caption);
                    figure.onclick = function() {
                        showZoomView(imgData.code, imgData.src);
                    };
                    fragment.appendChild(figure);
                }
                gallery.innerHTML = '';
                gallery.appendChild(fragment);
                renderPagination();
                gallery.classList.remove('loading');
                gallery.style.display = '';
            });
        }

        
        function renderPagination() {
            let pagination = document.getElementById('gallery-pagination');
            if (!pagination) {
                pagination = document.createElement('div');
                pagination.id = 'gallery-pagination';
                gallery.parentNode.insertBefore(pagination, document.getElementById('gallery-message'));
            }
            const totalPages = Math.ceil(galleryImages.length / PAGE_SIZE);
            let html = `
                <button class="pagination-btn" id="prev-page" ${currentPage === 1 ? 'disabled' : ''} title="Trang tr∆∞·ªõc"><span class="arrow">&#8592;</span></button>
                <div class="pagination-center">
                    <span>Trang</span>
                    <input type="text" inputmode="numeric" pattern="[0-9]*" min="1" max="${totalPages}" value="${currentPage}" class="pagination-current" id="page-input" style="width:44px;text-align:center;">
                    <span>/ ${totalPages}</span>
                </div>
                <button class="pagination-btn" id="next-page" ${currentPage === totalPages ? 'disabled' : ''} title="Trang sau"><span class="arrow">&#8594;</span></button>
            `;
            pagination.innerHTML = html;

            document.getElementById('prev-page').onclick = () => {
                if (currentPage > 1) {
                    currentPage--;
                    renderGalleryPage(currentPage);
                }
            };
            document.getElementById('next-page').onclick = () => {
                if (currentPage < totalPages) {
                    currentPage++;
                    renderGalleryPage(currentPage);
                }
            };

            const pageInput = document.getElementById('page-input');
            let lastPageValue = currentPage;

            pageInput.onfocus = function() {
                lastPageValue = this.value;
                this.value = '';
            };
            pageInput.onblur = function() {
                let val = parseInt(this.value, 10);
                if (isNaN(val)) {
                    this.value = lastPageValue;
                    return;
                }
                if (val < 1) val = 1;
                if (val > totalPages) val = totalPages;
                
                currentPage = val;
                renderGalleryPage(currentPage);
            };
            pageInput.onkeydown = function(e) {
                if (e.key === 'Enter') {
                    this.blur();
                }
            };
        }

        
        function renderSearchPage(page) {
            gallery.classList.add('loading');
            gallery.style.display = 'none';
            requestAnimationFrame(() => {
                const start = (page - 1) * PAGE_SIZE;
                const end = Math.min(start + PAGE_SIZE, searchResults.length);
                const items = end - start;
                
                const fragment = document.createDocumentFragment();
                for (let i = 0; i < items; i++) {
                    const imgData = searchResults[start + i];
                    const figure = document.createElement('figure');
                    const img = document.createElement('img');
                    img.width = 200;
                    img.height = 200;
                    img.loading = "lazy";
                    img.style.display = "block";
                    img.src = imgData.src;
                    img.alt = imgData.code;
                    figure.appendChild(img);
                    const caption = document.createElement('figcaption');
                    caption.textContent = imgData.code;
                    figure.appendChild(caption);
                    figure.onclick = function() {
                        showZoomView(imgData.code, imgData.src);
                    };
                    fragment.appendChild(figure);
                }
                gallery.innerHTML = '';
                gallery.appendChild(fragment);
                renderSearchPagination();
                gallery.classList.remove('loading');
                gallery.style.display = '';
            });
        }

        
        function renderSearchPagination() {
            let pagination = document.getElementById('gallery-pagination');
            if (!pagination) {
                pagination = document.createElement('div');
                pagination.id = 'gallery-pagination';
                gallery.parentNode.insertBefore(pagination, document.getElementById('gallery-message'));
            }
            const totalPages = Math.ceil(searchResults.length / PAGE_SIZE) || 1;
            if (totalPages <= 1) {
                pagination.innerHTML = '';
                return;
            }
            let html = `
                <button class="pagination-btn" id="prev-search-page" ${searchPage === 1 ? 'disabled' : ''} title="Trang tr∆∞·ªõc"><span class="arrow">&#8592;</span></button>
                <div class="pagination-center">
                    <span>Trang</span>
                    <input type="text" inputmode="numeric" pattern="[0-9]*" min="1" max="${totalPages}" value="${searchPage}" class="pagination-current" id="search-page-input" style="width:44px;text-align:center;">
                    <span>/ ${totalPages}</span>
                </div>
                <button class="pagination-btn" id="next-search-page" ${searchPage === totalPages ? 'disabled' : ''} title="Trang sau"><span class="arrow">&#8594;</span></button>
            `;
            pagination.innerHTML = html;

            document.getElementById('prev-search-page').onclick = () => {
                if (searchPage > 1) {
                    searchPage--;
                    renderSearchPage(searchPage);
                }
            };
            document.getElementById('next-search-page').onclick = () => {
                if (searchPage < totalPages) {
                    searchPage++;
                    renderSearchPage(searchPage);
                }
            };

            const searchPageInput = document.getElementById('search-page-input');
            let lastSearchPageValue = searchPage;

            searchPageInput.onfocus = function() {
                lastSearchPageValue = this.value;
                this.value = '';
            };
            searchPageInput.onblur = function() {
                let val = parseInt(this.value, 10);
                if (isNaN(val)) {
                    this.value = lastSearchPageValue;
                    return;
                }
                if (val < 1) val = 1;
                if (val > totalPages) val = totalPages;
                
                searchPage = val;
                renderSearchPage(searchPage);
            };
            searchPageInput.onkeydown = function(e) {
                if (e.key === 'Enter') {
                    this.blur();
                }
            };
        }

        
        let searchDebounce;
        searchInput.addEventListener('input', function() {
            zoomView.style.display = "none";
            clearTimeout(searchDebounce);
            searchDebounce = setTimeout(() => {
                
                document.getElementById('searchResult').innerHTML = '';
            }, 300);
        });

        searchInput.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                e.stopPropagation();
                const query = this.value.trim().toLowerCase();
                document.getElementById('searchResult').innerHTML = '';
                isSearching = !!query;
                searchResults = [];
                searchPage = 1;
                if (query) {
                    // S·ª≠ d·ª•ng h√†m searchProducts t·ª´ searchUtils.js
                    searchResults = window.searchProducts(query, galleryImages, window.products || {});
                    if (searchResults.length === 0) {
                        gallery.innerHTML = '';
                        document.getElementById('searchResult').innerHTML = '';
                        let pagination = document.getElementById('gallery-pagination');
                        if (pagination) pagination.innerHTML = '';
                    } else {
                        renderSearchPage(searchPage);
                    }
                } else {
                    isSearching = false;
                    searchResults = [];
                    searchPage = 1;
                    renderGalleryPage(currentPage);
                    let pagination = document.getElementById('gallery-pagination');
                    if (pagination) pagination.style.display = '';
                }
                const isMobile = window.matchMedia('(max-width: 600px) and (hover: none) and (pointer: coarse)').matches;
                if (isMobile) this.blur();
            }
        });

        function showZoomView(code, imgSrc) {
            const product = window.products?.[code];
            zoomView.style.display = "flex";
            zoomView.querySelector('.zoom-img').src = imgSrc;
            zoomView.querySelector('.zoom-img').alt = product?.name || code;
            zoomView.querySelector('.zoom-title').textContent = product?.name || code;
            zoomView.querySelector('.zoom-price').textContent = product?.price || "";
            zoomView.querySelector('.zoom-size-color').innerHTML = `
                <span style="color:#2196f3;">K√≠ch c·ª°:</span> ${product?.size || "ƒêang c·∫≠p nh·∫≠t"}
                <br>
                <span style="color:#2196f3;">M√†u s·∫Øc:</span> ${product?.color || "ƒêang c·∫≠p nh·∫≠t"}
            `;
            zoomView.querySelector('.zoom-intro').textContent = product?.intro || "";
            zoomView.querySelector('.zoom-close').onclick = function() {
                zoomView.style.display = "none";
            };
            setTimeout(() => {
                zoomView.scrollIntoView({ behavior: "auto", block: "center" });
            }, 0);
        }

        
        const menuItems = document.querySelectorAll('.menu a');
        const popup = document.getElementById('dynamic-popup');
        const lienheIcon = document.querySelector('.menu a[href="#lienhe"]');
        const searchIcon = document.querySelector('.menu a[href="#tiemkim"]'); 
        const searchPopup = document.getElementById('search-popup');

        menuItems.forEach((item) => {
            function handler(e) {
                if (item._handled) return;
                item._handled = true;
                setTimeout(() => { item._handled = false; }, 300);

                const isMobile = window.matchMedia('(max-width: 600px) and (hover: none) and (pointer: coarse)').matches;

                if (isMobile) {
                    if (this.classList.contains('active')) {
                        this.classList.remove('active');
                        if (this === lienheIcon) popup.classList.remove('active');
                        if (this === searchIcon) {
                            searchPopup.classList.remove('active');
                            searchInput.value = '';
                            document.getElementById('searchResult').innerHTML = '';
                            if (isSearching) {
                                isSearching = false;
                                searchResults = [];
                                searchPage = 1;
                                renderGalleryPage(currentPage);
                            }
                        }
                    } else {
                        this.classList.add('active');
                        if (this === lienheIcon) {
                            popup.classList.add('active');
                        }
                        if (this === searchIcon) {
                            searchPopup.classList.add('active');
                            searchInput.value = '';
                            document.getElementById('searchResult').innerHTML = '';
                        }
                    }
                    return;
                }

                if (this.classList.contains('active')) {
                    this.classList.remove('active');
                    if (this === lienheIcon) popup.classList.remove('active');
                    if (this === searchIcon) {
                        searchPopup.classList.remove('active');
                        searchInput.value = '';
                        document.getElementById('searchResult').innerHTML = '';
                        if (isSearching) {
                            isSearching = false;
                            searchResults = [];
                            searchPage = 1;
                            renderGalleryPage(currentPage);
                        }
                    }
                    return;
                }
                menuItems.forEach(i => i.classList.remove('active'));
                popup.classList.remove('active');
                searchPopup.classList.remove('active');
                this.classList.add('active');
                if (this === lienheIcon) {
                    popup.classList.add('active');
                }
                if (this === searchIcon) {
                    searchPopup.classList.add('active');
                    searchInput.value = '';
                    document.getElementById('searchResult').innerHTML = '';
                }
            }

            item.addEventListener('touchstart', handler);
            item.addEventListener('click', handler);
        });

        let lastScroll = window.scrollY;
        const menu = document.querySelector('.menu');
        menu.classList.add('show');

        window.addEventListener('scroll', function() {
            let currentScroll = window.scrollY;
            const isMobile = window.matchMedia('(max-width: 600px) and (hover: none) and (pointer: coarse)').matches;
            if (!isMobile) {
                if (
                    searchPopup.classList.contains('active') &&
                    (isSearching && searchResults.length > 0)
                ) {
                    if (currentScroll < lastScroll) {
                        menu.classList.add('show');
                        menu.classList.remove('hide');
                        searchPopup.classList.add('active');
                    } else if (currentScroll > lastScroll) {
                        menu.classList.add('hide');
                        menu.classList.remove('show');
                        searchPopup.classList.remove('active');
                    }
                    lastScroll = currentScroll;
                    return;
                }
                if (
                    searchPopup.classList.contains('active') &&
                    searchInput.value.trim() !== ''
                ) {
                    menu.classList.add('show');
                    menu.classList.remove('hide');
                    return;
                }
                if (currentScroll < lastScroll) {
                    menu.classList.add('show');
                    menu.classList.remove('hide');
                    if (lienheIcon.classList.contains('active')) {
                        popup.classList.add('active');
                    }
                    if (searchPopup && document.querySelector('.menu a[href="#tiemkim"]').classList.contains('active')) {
                        searchPopup.classList.add('active');
                    }
                } else if (currentScroll > lastScroll) {
                    menu.classList.add('hide');
                    menu.classList.remove('show');
                    popup.classList.remove('active');
                    if (searchPopup) {
                        searchPopup.classList.remove('active');
                        searchInput.value = '';
                        document.getElementById('searchResult').innerHTML = '';
                    }
                }
                lastScroll = currentScroll;
            } else {
                menu.classList.add('show');
                menu.classList.remove('hide');
                lastScroll = currentScroll;
            }
        });

        window.addEventListener('resize', () => {
            const newPageSize = window.innerWidth <= 600 ? 10 : 15;
            if (PAGE_SIZE !== newPageSize) {
                PAGE_SIZE = newPageSize;
                if (isSearching && searchResults.length > 0) {
                    renderSearchPage(1);
                } else {
                    renderGalleryPage(1);
                }
            }
        });

        window.addEventListener('DOMContentLoaded', function() {
            setTimeout(function() {
                document.getElementById('intro-overlay').classList.add('hide');
                setTimeout(function() {
                    document.body.classList.remove('hidden-body');
                }, 10);
            }, 500);
        });

        
        loadGalleryImages(function() {
            renderGalleryPage(currentPage);
                
                setTimeout(function() {
                    var modal = document.getElementById('modal-huongdan');
                    if (modal) modal.style.display = 'flex';
                }, 400);
        });
            
            document.addEventListener('DOMContentLoaded', function() {
                var btn = document.getElementById('close-huongdan');
                if (btn) btn.onclick = function() {
                    var modal = document.getElementById('modal-huongdan');
                    if (modal) modal.style.display = 'none';
                };
            });
    </script>
</body>

</html>